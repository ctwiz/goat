<table>
  <thead>
    <tr>
      <td>ID</td>
      <td>Company</td>
      <td>Reporting Date</td>
      <td>Fiscal Quarter</td>
      <td>Last year's EPS</td>
      <td>EPS forecast</td>
      <td>Forecast suggestion</td>
      <td>Magnitude</td>
      <td>Last Updated</td>
    </tr>
  </thead>
  <tbody>
    <% @earnings.each do |earning| %>
      <% l_e = earning.last_year_eps.to_i %>
      <% f_e = earning.eps_forecast.to_i %>
      <tr>
        <td><%=earning.id%></td>
        <td><%=link_to earning.company.name, company_path(earning.company)%></td>
        <td><%=earning.reporting_date.strftime("%F")%></td>
        <td><%=earning.fiscal_quarter%></td>
        <td><%=earning.last_year_eps%></td>
        <td><%=earning.eps_forecast%></td>
        <td>
          <% if earning.down? %>
            <div class="red down"></div>
          <% elsif earning.nochange? %>
            <div class="grey nochange"></div>
          <% elsif earning.up? %>
            <div class="green up"></div>
          <% end %>
        </td>
        <td style="text-align: right">
          <% if earning.down? %>
            <span class="red">
          <% elsif earning.nochange? %>
            <span class="grey">
          <% elsif earning.up? %>
            <span class="green">
          <% end %>
            <% begin %>
                <%=(Math.sqrt((f_e)*(f_e) + (l_e)*(l_e))).round(2)%>
            <% rescue %>
            <% end %>
            </span>
        </td>
        <td><%=earning.updated_at.in_time_zone("Pacific Time (US & Canada)").strftime("%F")%></td>
      </tr>
    <% end %>
  </tbody>
</table>